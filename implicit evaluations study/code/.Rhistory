geom_quasirandom(aes(color = species), size = 10, alpha = 0.8) +
scale_color_manual(values = c("red", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "grey"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow")
BadPenguinPlot
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.9) +
geom_boxplot(width = 0.1, outlier.shape = 10, alpha = 0) +
geom_quasirandom(aes(color = species), size = 10, alpha = 0.8) +
scale_color_manual(values = c("red", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "grey"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.9) +
geom_boxplot(width = 10, outlier.shape = 10, alpha = 0) +
geom_quasirandom(aes(color = species), size = 10, alpha = 0.8) +
scale_color_manual(values = c("red", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "grey"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.9) +
geom_boxplot(width = 10, outlier.shape = 100, alpha = 0) +
geom_quasirandom(aes(color = species), size = 10, alpha = 0.8) +
scale_color_manual(values = c("red", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "grey"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.9) +
geom_boxplot(width = 10, outlier.shape = 100, alpha = 5) +
geom_quasirandom(aes(color = species), size = 10, alpha = 0.8) +
scale_color_manual(values = c("red", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "grey"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot
data("penguins")
GoodPenguinPlot <- penguins %>%
na.omit() %>%
# Initialize a ggplot with species on the x-axis, body_mass_g on the y-axis, and fill color based on species
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
# Add a violin plot layer: untrimmed for full data representation, semi-transparent, with black outlines
geom_violin(trim = FALSE, alpha = 0.5, color = "black") +
# Add a boxplot layer: narrow width, no outliers, transparent fill, black outlines
geom_boxplot(width = 0.2, outlier.shape = NA, alpha = 0, color = "black") +
# Add jittered points using quasirandom placement to prevent overplotting, colored by species
geom_quasirandom(aes(color = species), size = 1, alpha = 0.8) +
# Apply the viridis color scale for the fill (nice for printing/colourblind people)
scale_fill_viridis(discrete = TRUE) +
# Apply the viridis color scale for the point colors
scale_color_viridis(discrete = TRUE) +
# Set the plot title and axis labels
labs(x = "Species", y = "Weight (g)") +
# Apply a minimalistic theme for a cleaner look
theme_minimal()+
# Remove the legend, because it would be redundant
theme(legend.position = "none")
GoodPenguinPlot
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.9) +
geom_boxplot(width = 10, outlier.shape = 100, alpha = 5) +
geom_quasirandom(aes(color = species), size = 10, alpha = 0.8) +
scale_color_manual(values = c("pink", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "grey"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.9) +
geom_boxplot(width = 10, outlier.shape = 100, alpha = 5, fill = "pink") +
geom_quasirandom(aes(color = species), size = 10, alpha = 0.8) +
scale_color_manual(values = c("pink", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "grey"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.9) +
geom_boxplot(width = 10, outlier.shape = 100, alpha = 5, fill = "orange") +
geom_quasirandom(aes(color = species), size = 10, alpha = 0.8) +
scale_color_manual(values = c("pink", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "grey"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.9) +
geom_boxplot(width = 10, outlier.shape = 100, alpha = 5, fill = "orange", "pink","pink") +
geom_quasirandom(aes(color = species), size = 10, alpha = 0.8) +
scale_color_manual(values = c("pink", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "grey"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.9) +
geom_boxplot(width = 10, outlier.shape = 100, alpha = 5, fill = "orange") +
geom_quasirandom(aes(color = species), size = 10, alpha = 0.8) +
scale_color_manual(values = c("pink", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "grey"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.9) +
geom_boxplot(width = 10, outlier.shape = 100, alpha = 5, fill = "pink") +
geom_quasirandom(aes(color = species), size = 10, alpha = 0.8) +
scale_color_manual(values = c("pink", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "grey"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.9) +
geom_boxplot(width = 10, outlier.shape = 100, alpha = 5, fill = "pink") +
geom_quasirandom(aes(color = species), size = 10, alpha = 0.8) +
scale_color_manual(values = c("lightpink", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "grey"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.9) +
geom_boxplot(width = 10, outlier.shape = 20, alpha = 5, fill = "pink") +
geom_quasirandom(aes(color = species), size = 10, alpha = 0.8) +
scale_color_manual(values = c("lightpink", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "grey"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot
BadPenguinPlot
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.9) +
geom_boxplot(width = 10, outlier.shape = 20, alpha = 5, fill = "pink") +
geom_quasirandom(aes(color = species), size = 10, alpha = 0.8) +
scale_color_manual(values = c("lightpink", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "lightgreen"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.9) +
geom_boxplot(width = 10, outlier.shape = 2, alpha = 5, fill = "pink") +
geom_quasirandom(aes(color = species), size = 10, alpha = 0.8) +
scale_color_manual(values = c("lightpink", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "lightgreen"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.9) +
geom_boxplot(width = 10, outlier.shape = 20, alpha = 5, fill = "pink") +
geom_quasirandom(aes(color = species), size = 10, alpha = 0.8) +
scale_color_manual(values = c("lightpink", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "lightgreen"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.9) +
geom_boxplot(width = 10, outlier.shape = 16, alpha = 5, fill = "pink") +
geom_quasirandom(aes(color = species), size = 10, alpha = 0.8) +
scale_color_manual(values = c("lightpink", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "lightgreen"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.9) +
geom_boxplot(width = 10, outlier.shape = 1, alpha = 5, fill = "pink") +
geom_quasirandom(aes(color = species), size = 10, alpha = 0.8) +
scale_color_manual(values = c("lightpink", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "lightgreen"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.9) +
geom_boxplot(width = 10, outlier.shape = 1, alpha = 0.5, fill = "pink") +
geom_quasirandom(aes(color = species), size = 10, alpha = 0.8) +
scale_color_manual(values = c("lightpink", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "lightgreen"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.9) +
geom_boxplot(width = 10, outlier.shape = 1, alpha = 0.5, fill = "pink") +
geom_quasirandom(aes(color = species), size = 10, alpha = 0.5) +
scale_color_manual(values = c("lightpink", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "lightgreen"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.5) +
geom_boxplot(width = 10, outlier.shape = 1, alpha = 0.5, fill = "pink") +
geom_quasirandom(aes(color = species), size = 10, alpha = 0.5) +
scale_color_manual(values = c("lightpink", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "lightgreen"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.5) +
geom_boxplot(width = 10, outlier.shape = 1, alpha = 0.5, fill = "pink") +
geom_quasirandom(aes(color = species), size = 10, alpha = 1) +
scale_color_manual(values = c("lightpink", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "lightgreen"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.5, fill = "pink") +
geom_boxplot(width = 10, outlier.shape = 1, alpha = 0.5, fill = "pink") +
geom_quasirandom(aes(color = species), size = 10, alpha = 1) +
scale_color_manual(values = c("lightpink", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "lightgreen"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.5, fill = "grey") +
geom_boxplot(width = 10, outlier.shape = 1, alpha = 0.5, fill = "pink") +
geom_quasirandom(aes(color = species), size = 10, alpha = 1) +
scale_color_manual(values = c("lightpink", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "lightgreen"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot
# Save the GoodPenguinPlot as a PDF
pdf("plot_good_[Lukas].pdf")
print(GoodPenguinPlot)  # print the plot
dev.off()  # close the device
# Save GoodPenguinPlot as a PDF
ggsave("plot_good_[Lukas].pdf", plot = GoodPenguinPlot)
# Save BadPenguinPlot as a PDF
ggsave("plot_bad_[Lukas].pdf", plot = BadPenguinPlot)
knitr::opts_chunk$set(message = FALSE,
warning = FALSE)
library(magick)
library(palmerpenguins)
library(tidyverse)
library(ggplot2)
library(datasets)
library(ggbeeswarm)
library(viridis)
library(grid)
library(ggimage)
library(imager)
library(ggmagnify)
library(viridis)
data("penguins")
#The data originates from a long-term biological study on penguins at the Palmer Station in Antarctica, and is available in the free dataset of the R Studio library palmerpenguins.
# Raincloud Plot
GoodPenguinPlot <- penguins %>%
na.omit() %>%
# Initialize a ggplot with species on the x-axis, body_mass_g on the y-axis, and fill color based on species
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
# Add a violin plot layer: untrimmed for full data representation, semi-transparent, with black outlines
geom_violin(trim = FALSE, alpha = 0.5, color = "black") +
# Add a boxplot layer: narrow width, no outliers, transparent fill, black outlines
geom_boxplot(width = 0.2, outlier.shape = NA, alpha = 0, color = "black") +
# Add jittered points using quasirandom placement to prevent overplotting, colored by species
geom_quasirandom(aes(color = species), size = 1, alpha = 0.8) +
# Apply the viridis color scale for the fill (nice for printing/colourblind people)
scale_fill_viridis(discrete = TRUE) +
# Apply the viridis color scale for the point colors
scale_color_viridis(discrete = TRUE) +
# Set the plot title and axis labels
labs(x = "Species", y = "Weight (g)") +
# Apply a minimalistic theme for a cleaner look
theme_minimal()+
# Remove the legend, because it would be redundant
theme(legend.position = "none")
GoodPenguinPlot
background_picture <- image_read("Penguinpicture.png")
# Define the area to be magnified
from <- c(xmin = 1, xmax = 2, ymin = 3500, ymax = 4000)
# Define where to place the magnified inset on the plot
to <- c(xmin = 2, xmax = 3, ymin = 3000, ymax = 3500)
BadPenguinPlot <- penguins %>%
na.omit() %>%
ggplot(aes(x = species, y = body_mass_g, fill = species)) +
annotation_custom(rasterGrob(as.raster(background_picture), width = unit(1, "npc"), height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
geom_violin(trim = 3500, alpha = 0.5, fill = "grey") +
geom_boxplot(width = 10, outlier.shape = 1, alpha = 0.5, fill = "pink") +
geom_quasirandom(aes(color = species), size = 10, alpha = 1) +
scale_color_manual(values = c("lightpink", "darkred", "#880808")) +
scale_y_continuous(limits = c(3000, 4500)) +
geom_magnify(from =  from, to = to) +
theme(text = element_text(color = "lightgreen"),
axis.title = element_text(color = "grey"),
axis.text = element_text(color = "lightblue"),
legend.title = element_text(color = "lightgrey"),
legend.text = element_text(color = "lightyellow"))
BadPenguinPlot
#the background of the plot is a programmin penguin which is
#the size of the datapoints is too big aswell as the size and with of the boxplots
#the categories are placed too close together
# with the alpha level of the quasidrome set to 1, they are intransparent and with the size set too big they cover up the violin plot.
#the scale cuts of some datapoints
#the coulour of the Plots is ugly and not deutlich unterscheidbar zwischen den Kategorien.
# the legend is redandant
# geom magnify overwrites data and doesnt ,magnify a useful area
#colour of text elements is set to a barely visiblle
# Save GoodPenguinPlot as a PDF
ggsave("plot_good_[Lukas].pdf", plot = GoodPenguinPlot)
# Save GoodPenguinPlot as a PDF
ggsave("plot_good_[Lukas].pdf", plot = GoodPenguinPlot)
# Save BadPenguinPlot as a PDF
ggsave("plot_bad_[Lukas].pdf", plot = BadPenguinPlot)
sessionInfo()
# Save GoodPenguinPlot as a PNG
ggsave("plot_good_[Lukas].png", plot = GoodPenguinPlot)
# Save BadPenguinPlot as a PNG
ggsave("plot_bad_[Lukas].png", plot = BadPenguinPlot)
# Save BadPenguinPlot as a PNG
ggsave("plot_bad_[Lukas].png", plot = BadPenguinPlot)
